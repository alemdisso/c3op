<?php

$pageData = $this->pageData;

$projectInfo = $pageData['projectInfo'];



        //  projectHeader
        //    id
        //    projectTitle
        //    clientName
        //    areaActivity
        //    ourResponsible
        //    responsibleAtClient
        //    overhead
        //    managementFee
        //    contractValue
        //    contractDate
        //
$projectHeader = $pageData['projectHeader'];

        // productsList
        //   * id =>
        //      productTitle
        //      predictedDate
        //      realDate
        //      predictedValue
        //      realValue

$productsList = $pageData['productsList'];


$outlaysList = $pageData['outlaysList'];

?>
    <div id="MainHeader">
      <h1><?php echo $this->translate("#Project") ?> <?php print($projectHeader['projectTitle']) ?></h1>
    </div>

    <div class="Area">

      <div class="three columns alpha Right">
        <?php echo $this->translate("#Client:") ?>
      </div>
      <div class="six columns">
        <?php print($projectHeader['clientName']) ?>
      </div>
      <div class="three columns Right">
        <?php echo $this->translate("#Overhead:") ?>
      </div>
      <div class="two columns omega">
        <?php print($projectHeader['overhead']) ?> %
      </div>

      <div class="three columns alpha Right">
        <?php echo $this->translate("#Area activity:") ?>
      </div>
      <div class="six columns">
        <?php print($this->translate($projectHeader['areaActivity'])) ?>
      </div>
      <div class="three columns Right">
        <?php echo $this->translate("#Management fee:") ?>
      </div>
      <div class="two columns omega">
        <?php print($projectHeader['managementFee']) ?> % <!-- ### Talvez seja necessário esconder este campo (re: confusão da Beth sobre o seu uso) -->
      </div>

      <div class="three columns alpha Right">
        <?php echo $this->translate("#Our responsible:") ?>
      </div>
      <div class="six columns">
        <?php print($projectHeader['ourResponsible']) ?>
      </div>
      <div class="three columns Right">
        <?php echo $this->translate("#Contract value:") ?>
      </div>
      <div class="two columns omega">
        <?php print($projectHeader['contractValue']) ?>
      </div>

      <div class="three columns alpha Right">
        <?php echo $this->translate("#Responsible at client:") ?>
      </div>
      <div class="six columns">
        <?php print($projectHeader['responsibleAtClient']) ?>
      </div>
      <div class="three columns Right">
        <?php echo $this->translate("#Contract date:") ?>
      </div>
      <div class="two columns omega">
        <?php print($projectHeader['contractDate']) ?>
      </div>
    </div><!-- .Area -->

    <div id="tabs">
      <ul>
        <li><a href="#tabs-1"><?php echo $this->translate("#Receiving") ?></a></li>
        <li><a href="#tabs-2"><?php echo $this->translate("#Payments") ?></a></li>
        <li><a href="#tabs-3"><?php echo $this->translate("#Staff") ?></a></li>
      </ul>

      <div id="tabs-1">
        <div class="Area">
           <h2><?php echo $this->translate("#Receiving") ?></h2>
           <table id="Produtos" class="display dataTable">
              <thead>
                <tr>
                  <th width="300"><?php echo $this->translate("#Product") ?></th>
                  <th width="50"><?php echo $this->translate("#Predicted date") ?></th>
                  <th width="50"><?php echo $this->translate("#Real date") ?></th>
                  <th width="50"><?php echo $this->translate("#Predicted value") ?></th>
                  <th width="50"><?php echo $this->translate("#Real value") ?></th>
                  <th width="1%">&nbsp;</th>
                </tr>
              </thead>
              <tbody>

                <!-- ### loop de carga das ações que são produto -->
<?php
foreach($productsList as $id => $productInfo) {
?>
                <tr>
                  <td>
                    <a href="/projects/action/detail/?id=<?php print($id) ?>"><?php print($productInfo['productTitle']) ?></a>
                  </td>
                  <td>
                    <?php print($productInfo['predictedDate']) ?>
                  </td>
                  <td>
                    <?php print($productInfo['realDate']) ?>
                  </td>
                  <td class="Right">
                    <?php print($productInfo['predictedValue']) ?>
                  </td>
                  <td class="Right">
                    <?php print($productInfo['realValue']) ?>
                  </td>
                  <td>
                    <a href="#" class="anchorclass" rel="submenu1"><?php echo $this->translate("#Options") ?></a>
                    <div id="submenu1" class="anylinkcss">
                        <ul>
                          <li>
                            <!-- [# LINK PARA A EDIÇÃO DO PRODUTO ] -->
                            <a href="/projects/action/edit/?id=<?php echo $id ?>"><?php echo $this->translate("#Edit") ?></a>
                          </li>
                          <li>
                            <!-- [# LINK PARA FORM DE CONFIRMAÇÃO DE RECEBIMENTO -> VAI ABRIR EM BOX DE DIÁLOGO MODAL ] -->
                            <a href="/projects/receivable/notify/?id=<?php echo '/#' ?>"><?php echo $this->translate("#Notify receiving") ?></a>
                          </li>
                          <li>
                            <!-- [# LINK PARA PÁGINA DE DETALHAMENTO DO PRODUTO ] -->
                            <a href="/projects/action/detail/?id=<?php echo $id ?>"><?php echo $this->translate("#Product details") ?></a>
                          </li>
                        </ul>
                    </div><!-- #submenu1 -->
                  </td>
                </tr>
<?php
}
?>

              </tbody>
            </table><br />
            <p>
              <a href="/projects/receivable/create/?project=<?php echo $projectHeader['id'] ?>" class="button three columns alpha omega"><?php echo $this->translate("#Predict receiving") ?></a>
            </p>
          </div><!-- Area -->
        </div><!-- tabs-1 -->

        <div id="tabs-2">
          <div class="Area">
            <h2><?php echo $this->translate("#Payments") ?></h2>

<!-- ### INSERÇÃO DO CÓDIGO DE PAYABLES.PHTML COM ALTERAÇÕES DE RPORTO -->

<?php
/*
 * if there is payables in list
 */
      if (count($outlaysList)) {
?>


           <table id="Pagamentos" class="display dataTable">
              <thead>
                <tr>
                  <th width="300"><?php echo $this->translate("#Action") ?></th>
                  <th width="300"><?php echo $this->translate("#Payee") ?></th>
                  <th width="50"><?php echo $this->translate("#Predicted date") ?></th>
                  <th width="50"><?php echo $this->translate("#Real date") ?></th>
                  <th width="50"><?php echo $this->translate("#Predicted value") ?></th>
                  <th width="50"><?php echo $this->translate("#Real value") ?></th>
                  <th width="1%">&nbsp;</th>
                </tr>
              </thead>
              <tbody>

<?php

foreach($outlaysList as $id => $outlayInfo) {
?>
                <!-- ### loop de carga das ações que geram pagamentos -->
                <tr>
                  <td>
                    <a href="/projects/action/detail/?id=<?php print($outlayInfo['actionId']) ?>"><?php print($outlayInfo['actionTitle']) ?></a>
                  </td>
                  <td>
                    <a href="<?php print(($outlayInfo['payeeId'] > 0 ? '/register/contact/detail/?id=' . $outlayInfo['payeeId'] : "#")) ?>"><?php print($outlayInfo['payeeName']) ?></a>
                  </td>
                  <td>
                    <?php print($outlayInfo['predictedDate']) ?>
                  </td>
                  <td>
                    <?php print($outlayInfo['realDate']) ?>
                  </td>
                  <td class="Right">
                    <?php print($outlayInfo['predictedValue']) ?>
                  </td>
                  <td class="Right">
                    <?php print($outlayInfo['realValue']) ?>
                  </td>
                  <td>
                    <a href="#" class="anchorclass" rel="submenu1"><?php echo $this->translate("#Options") ?></a>
                    <div id="submenu1" class="anylinkcss">
                        <ul>
                          <li>
                            <!-- [# LINK PARA A EDIÇÃO DO PAGAMENTO ] -->
                            <a href="/projects/outlay/edit/?id=<?php print($id) ?>"><?php echo $this->translate("#Edit") ?></a>
                          </li>
                          <li>
                            <!-- [# LINK PARA FORM DE CONFIRMAÇÃO DE PAGAMENTO -> VAI ABRIR EM BOX DE DIÁLOGO MODAL ] -->
                            <a href="/projects/outlay/confirm/?id=<?php print($id) ?>"><?php echo $this->translate("#Confirm payment") ?></a>
                          </li>
                          <li>
                            <!-- [# LINK PARA PÁGINA DE DETALHAMENTO DO PAGAMENTO ] -->
                            <a href="/projects/outlay/detail/?id=<?php print($id) ?>"><?php echo $this->translate("#Outlay details") ?></a>
                          </li>
                        </ul>
                    </div><!-- #submenu1 -->
                  </td>
                </tr>
<?php
}
?>
                <!-- ### fim do loop de carga das ações que são produto -->

              </tbody>
            </table><br />

            <p>
              <!-- [# LINK PARA PÁGINA DE CRIAÇÃO DE PAGAMENTO ]  -->
              <a href="#" class="button three columns alpha omega"><?php echo $this->translate("#Predict outlay") ?></a>
            </p>

<?php
      } else { // end else there is payables in list
?>
            <p><?php print($this->translate("#There is no outlays related to this project.")) ?></p>

<?php
      } // end else there is payables in list
?>

<!-- ### FIM DA INSERÇÃO DO CÓDIGO DE PAYABLES.PHTML -->

          </div><!-- Area -->
        </div><!-- tabs-2 -->

<!-- ### ACHO QUE O CONTEÚDO DESTA ABA É NOVO - NÃO ENCONTREI EM NENHUM PHTM -->
        <div id="tabs-3">
          <div class="Area">
            <h2>Equipe</h2>
            <table id="Equipe" class="display dataTable">
              <thead>
                <tr>
                  <th width="220">Nome</th>
                  <th width="80">Função</th>
                  <th width="100">E-mail</th>
                  <th width="100">Telefone</th>
                  <th width="100">&nbsp;</th>
                </tr>
              </thead>
              <tbody>
              <!-- ### loop de carga dos recursos humanos alocados ao projeto -->
                <tr>
                  <td>
                    <a href="<?php print($projectInfo['linkHumanResource']) ?>"><?php print($projectInfo['humanResourceName']) ?></a>
                  </td>
                  <td>
                    <?php print($projectInfo['humanResourceFunction']) ?>
                  </td>
                  <td>
                    <a href="mailto:<?php print($projectInfo['humanResourceEmail']) ?>"><?php print($projectInfo['humanResourceEmail']) ?></a>
                  </td>
                  <td>
                    <?php print($projectInfo['humanResourcePhone']) ?>
                  </td>
                  <td>
                    <a href="#" class="anchorclass" rel="submenu1">Opções</a>
                    <div id="submenu1" class="anylinkcss">
                        <ul>
                          <li>
                            <!-- [# LINK PARA A EDIÇÃO DO CONTATO ] -->
                            <a href="<?php print($projectInfo['humanResourceEditLink']) ?>">Editar</a>
                          </li>
                          <li>
                            <!-- [# LINK PARA PÁGINA DO CONTATO ] -->
                            <a href="<?php print($projectInfo['linkHumanResource']) ?>">Ver contato</a>
                          </li>
                        </ul>
                    </div><!-- #submenu1 -->
                  </td>
                </tr>
              <!-- ### loop de carga dos recursos humanos alocados ao projeto -->
              </tbody>
            </table><br />

            <p>
              <!-- [# LINK PARA PÁGINA DE VINCULAÇÃO DE CONTATO À EQUIPE DO PROJETO ] -->
              <a href="#" class="button three columns alpha omega">Incluir membro</a>
            </p>
          </div><!-- Area -->
        </div><!-- tabs-3 -->
      </div><!-- #tabs -->

<?php
  if ($projectInfo['linkPayables'] != "") {
?>
      <p>
        <a class="info" href="<?php print($projectInfo['linkPayables']) ?>">Consultar ações realizadas</a><br />
      </p>
<?php
  }
?>
<?php
  if ($projectInfo['linkUnacknowledged'] != "") {
?>
      <p>
        <a class="info" href="<?php print($projectInfo['linkUnacknowledged']) ?>">Ações com início a confirmar</a><br />
      </p>
<?php
  }
?>
<?php
  if ($projectInfo['linkTree'] != "") {
?>
      <p>
        <a class="info" href="<?php print($projectInfo['linkTree']) ?>">Árvore de ações</a><br />
      </p>
<?php
  }
?>

  <h2>Produtos do Projeto</h2>
<?php
/*
 * iterate list and print title
 */

    $actionsList = $projectInfo['actionsList'];

    while (list(, $actionInfo) = each($actionsList)) {
?>
<p class="project_product_line">
<?php print($actionInfo['title']) ?>&nbsp;<?php print($actionInfo['specialAction']) ?> |
(<?php print($actionInfo['brood']) ?>) |
<?php if (isset($actionInfo['editLink'])) { ?>
<a href="<?php print($actionInfo['editLink']) ?>">Editar</a>
<?php } ?>
</p>


<?php
}  // loop iterate list and print titlei
?>



<p />
<br /><br /><a href="<?php print($projectInfo['linkActionCreate']) ?>">Criar Nova Ação</a>


